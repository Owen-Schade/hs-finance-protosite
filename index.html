<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Financial Manager</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <!-- NAVBAR: primary site navigation (fixed at top) -->
  <nav class="navbar">
    <div class="container nav-content">
      <div class="logo">MySite</div>
      <ul class="nav-links">
        <li><a href="#">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Services</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="container">
    <div class="hero">
      <h1>Financial Manager</h1>
    </div>

    <div class="financial-section">
      <!-- TRANSACTIONS: Add transactions here; supports check batches, account, memo, reconciled and void flags -->
      <h2>Transactions</h2>
      <div style="margin-bottom:8px;display:flex;gap:8px;align-items:center;">
        <button id="toggleEntryBtn" class="btn btn-secondary">New Entry</button>
        <button id="toggleGroupBtn" class="btn btn-secondary">New Group</button>
      </div>



      <table class="finance-table">
        <thead>
          <tr>
            <th>Date <button class="sort-btn" data-col="date" title="Sort">↕</button></th>
            <th>Check # <button class="sort-btn" data-col="check" title="Sort">↕</button></th>
            <th>Ref / Type <button class="sort-btn" data-col="ref" title="Sort">↕</button></th>
            <th>Payee / Account <button class="sort-btn" data-col="payee" title="Sort">↕</button></th>
            <th>Class / Location <button class="sort-btn" data-col="class" title="Sort">↕</button></th>
            <th>Payment <button class="sort-btn" data-col="payment" title="Sort">↕</button></th>
            <th>Deposit <button class="sort-btn" data-col="deposit" title="Sort">↕</button></th>
            <th>Memo <button class="sort-btn" data-col="memo" title="Sort">↕</button></th>
            <th>Rec. <button class="sort-btn" data-col="reconciled" title="Sort">↕</button></th>
            <th>Void <button class="sort-btn" data-col="voided" title="Sort">↕</button></th>
            <th>Balance</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <tr class="add-row" style="display:none;">
            <td><input type="date" id="newDate" class="inline-input"></td>
            <td><input type="text" id="newCheckNum" class="inline-input" placeholder="Check #"></td>
            <td>
              <div class="stack">
                <input type="text" id="newRef" class="inline-input" placeholder="Ref #">
                <select id="newType" class="inline-input">
                  <option value="">Select type</option>
                  <option value="Expenditure">Expenditure</option>
                  <option value="Transaction">Transaction</option>
                  <option value="Deposit">Deposit</option>
                </select>
              </div>
            </td>
            <td>
              <div class="stack">
                <input type="text" id="newPayee" class="inline-input" placeholder="Payee">
                <select id="newAccount" class="inline-input"></select>
              </div>
            </td>
            <td>
              <div class="stack">
                <input type="text" id="newClass" class="inline-input" placeholder="Class">
                <input type="text" id="newLocation" class="inline-input" placeholder="Location">
              </div>
            </td>
            <td><input type="number" id="newPayment" class="inline-input" placeholder="0.00" step="0.01"></td>
            <td><input type="number" id="newDeposit" class="inline-input" placeholder="0.00" step="0.01"></td>
            <td><input type="text" id="newMemo" class="inline-input" placeholder="Memo"></td>
            <td><input type="checkbox" id="newReconciled"></td>
            <td><input type="checkbox" id="newVoid"></td>
            <td></td>
            <td>
              <button class="btn btn-primary" id="addBtn">Add</button>
              <button class="btn btn-secondary" id="clearBtn">Cancel</button>
              <a href="#" id="showChecksLink" class="small-link" style="margin-left:8px;display:none;">Show checks</a>
            </td>
          </tr>
          <tr id="checksRow" class="checks-row" style="display:none;">
            <td colspan="12">
              <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
                <input type="text" id="checkNumInput" class="inline-input" placeholder="Check #">
                <input type="number" id="checkAmtInput" class="inline-input" placeholder="Amount" step="0.01">
                <button class="btn btn-primary" id="addCheckBtn">Add Check</button>
                <button class="btn btn-secondary" id="clearChecksBtn">Clear Checks</button>
                <div style="flex:1;text-align:right;">Checks total: <span id="checksTotal">$0.00</span></div>
              </div>
              <ul id="checksList" style="margin-top:10px;"></ul>
            </td>
          </tr>

          <!-- Inline Group Add Row (hidden by default) -->
          <tr id="groupAddRow" class="group-add-row" style="display:none;">
            <td><input type="date" id="groupDate" class="inline-input"></td>
            <td></td>
            <td>
              <div class="stack">
                <select id="groupType" class="inline-input">
                  <option value="">Select type</option>
                  <option value="Expenditure">Expenditure</option>
                  <option value="Transaction">Transaction</option>
                  <option value="Deposit">Deposit</option>
                </select>
                <input id="groupLocation" class="inline-input" placeholder="Location">
              </div>
            </td>
            <td>Group</td>
            <td></td>
            <td><input type="text" id="groupPayment" class="inline-input" disabled></td>
            <td><input type="text" id="groupDeposit" class="inline-input" disabled></td>
            <td><input type="text" id="groupMemo" class="inline-input" placeholder="Memo"></td>
            <td><input type="checkbox" id="groupReconciled"></td>
            <td><input type="checkbox" id="groupVoid"></td>
            <td></td>
            <td>
              <button id="addGroupBtn" class="btn btn-primary">Add Group</button>
              <button id="cancelGroupBtn" class="btn btn-secondary">Cancel</button>
            </td>
          </tr>

          <!-- Inline Group Check Entry Row (hidden by default) -->
          <tr id="groupCheckEntryRow" class="group-check-entry-row" style="display:none;">
            <td></td>
            <td><input type="text" id="grpCheckNum" class="inline-input" placeholder="Check #"></td>
            <td><input type="text" id="grpCheckRef" class="inline-input" placeholder="Ref #"></td>
            <td>
              <div class="stack">
                <input type="text" id="grpCheckPayee" class="inline-input" placeholder="Payee">
                <select id="grpCheckAccount" class="inline-input"></select>
              </div>
            </td>
            <td><input type="text" id="grpCheckClass" class="inline-input" placeholder="Class"></td>
            <td><input type="number" id="grpCheckAmt" class="inline-input" placeholder="Amount" step="0.01"></td>
            <td><input type="number" id="grpCheckDepositAmt" class="inline-input" placeholder="Deposit" step="0.01" style="display:none;"></td>
            <td>
              <input type="text" id="grpCheckDesc" class="inline-input" placeholder="Description">
              <input type="text" id="grpCheckMethod" class="inline-input" placeholder="Payment method" style="margin-top:6px;">
            </td>
            <td></td>
            <td></td>
            <td></td>
            <td>
              <select id="grpCheckType" class="inline-input"><option value="Payment">Payment</option><option value="Deposit">Deposit</option></select>
              <button id="addGroupCheckBtn" class="btn btn-primary">Add</button>
              <button id="clearGroupChecksBtn" class="btn btn-secondary">Clear Checks</button>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="summary">
        <!-- START/END BALANCES: Starting Balance persists and ending balance is computed offline (client-only) -->
        <p>Starting Balance: <input type="number" id="startingBalance" step="0.01" value="0.00" style="width:110px;"></p>
        <p>Total Payments: <span id="totalPayments">$0.00</span></p>
        <p>Total Deposits: <span id="totalDeposits">$0.00</span></p>
        <p>Net: <span id="netAmount">$0.00</span></p>
        <p>Ending Balance: <span id="endingBalance">$0.00</span></p>
      </div> 

    </div>
  </main>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2026 MySite — All rights reserved.</p>
    </div>
  </footer>

  <script defer src="js/storage.js"></script>
  <script defer src="js/checkManager.js"></script>
  <script defer src="js/accountManager.js"></script>
  <script defer src="js/app.js"></script>
</body>
</html>
